(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,81418,e=>{"use strict";var s=e.i(43476),t=e.i(18566),a=e.i(71645);let n={id:"1",name:"Campagne de Bienvenue T1",description:"Campagne trimestrielle de bienvenue pour les nouveaux clients",status:"sent",target:{scope:"client",count:1250,ids:["c1","c2","c3"]},channels:[{type:"email",templateName:"Email de Bienvenue",sentCount:1250,deliveredCount:1180,failedCount:70},{type:"sms",templateName:"Alerte SMS",sentCount:1250,deliveredCount:1220,failedCount:30}],schedule:{type:"scheduled",scheduledAt:"2024-01-15T10:00:00Z",cronExpression:null,timezone:"Europe/Paris",lastRunAt:"2024-01-15T10:00:00Z",nextRunAt:null},recipients:[{id:"r1",name:"John Doe",email:"john@example.com",status:"delivered",sentAt:"2024-01-15T10:01:00Z"},{id:"r2",name:"Jane Smith",email:"jane@example.com",status:"delivered",sentAt:"2024-01-15T10:01:00Z"},{id:"r3",name:"Bob Wilson",email:"bob@example.com",status:"failed",error:"Invalid email"},{id:"r4",name:"Alice Brown",email:"alice@example.com",phone:"+1234567893",status:"delivered",sentAt:"2024-01-15T10:02:00Z"},{id:"r5",name:"Charlie Davis",email:"charlie@example.com",status:"pending"}],createdAt:"2024-01-14T09:00:00Z",createdBy:"Jean Directeur",updatedAt:"2024-01-15T10:30:00Z"};async function i(e){return await new Promise(e=>setTimeout(e,500)),console.log("Fetching campaign details for:",e),{...n,id:e}}async function l(e){await new Promise(e=>setTimeout(e,300)),console.log("Cancelled campaign:",e)}async function r(e){await new Promise(e=>setTimeout(e,300)),console.log("Retrying campaign:",e)}async function d(e){return await new Promise(e=>setTimeout(e,500)),console.log("Exporting recipients for campaign:",e),new Blob(["name,email,status\nJohn Doe,john@example.com,delivered"],{type:"text/csv"})}let c={draft:"bg-gray-100 text-gray-700",scheduled:"bg-blue-100 text-blue-700",sending:"bg-yellow-100 text-yellow-700",sent:"bg-green-100 text-green-700",failed:"bg-red-100 text-red-700",cancelled:"bg-gray-100 text-gray-500"};function m(e){return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})}function o({campaign:e}){return(0,s.jsxs)("div",{className:"card p-6",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-bold",children:e.name}),e.description&&(0,s.jsx)("p",{className:"text-secondary mt-1",children:e.description})]}),(0,s.jsx)("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${c[e.status]}`,children:e.status})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 pt-4 border-t border-border",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-secondary",children:"CrÃ©Ã© Par"}),(0,s.jsx)("div",{className:"font-medium",children:e.createdBy})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-secondary",children:"CrÃ©Ã© Le"}),(0,s.jsx)("div",{className:"font-medium",children:m(e.createdAt)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-secondary",children:"DerniÃ¨re Mise Ã  Jour"}),(0,s.jsx)("div",{className:"font-medium",children:m(e.updatedAt)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-secondary",children:"Total Destinataires"}),(0,s.jsx)("div",{className:"font-medium",children:e.target.count.toLocaleString()})]})]})]})}let x={tenant:"Locataires",client:"Clients",final_client:"Clients Finaux",staff:"Personnel",role:"RÃ´les"},u={tenant:"ðŸ¢",client:"ðŸ‘¥",final_client:"ðŸ‘¤",staff:"ðŸ’¼",role:"ðŸ”‘"};function h({target:e}){return(0,s.jsxs)("div",{className:"card p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Audience Cible"}),(0,s.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-muted rounded-lg",children:[(0,s.jsx)("span",{className:"text-3xl",children:u[e.scope]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-semibold text-lg",children:x[e.scope]}),(0,s.jsxs)("div",{className:"text-secondary",children:[e.count.toLocaleString()," destinataires sÃ©lectionnÃ©s"]})]})]}),e.ids.length>0&&(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("div",{className:"text-sm text-secondary mb-2",children:"IDs SÃ©lectionnÃ©s :"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:e.ids.map(e=>(0,s.jsx)("span",{className:"px-2 py-1 bg-primary/10 text-primary rounded text-sm font-mono",children:e},e))})]})]})}let p={email:"Email",sms:"SMS",whatsapp:"WhatsApp",notification:"Notification Push"},j={email:"âœ‰ï¸",sms:"ðŸ’¬",whatsapp:"ðŸ“±",notification:"ðŸ””"};function g({channels:e}){return(0,s.jsxs)("div",{className:"card p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Performance des Canaux"}),(0,s.jsx)("div",{className:"space-y-4",children:e.map(e=>{var t,a;let n=(t=e.deliveredCount,0===(a=e.sentCount)?"0%":`${Math.round(t/a*100)}%`),i=e.sentCount>0?e.deliveredCount/e.sentCount*100:0;return(0,s.jsxs)("div",{className:"p-4 bg-muted rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-xl",children:j[e.type]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:p[e.type]}),(0,s.jsx)("div",{className:"text-sm text-secondary",children:e.templateName})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("div",{className:"font-semibold text-lg",children:n}),(0,s.jsx)("div",{className:"text-sm text-secondary",children:"Taux de Livraison"})]})]}),(0,s.jsx)("div",{className:"h-2 bg-border rounded-full overflow-hidden mb-3",children:(0,s.jsx)("div",{className:"h-full bg-green-500 rounded-full transition-all",style:{width:`${i}%`}})}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:e.sentCount.toLocaleString()}),(0,s.jsx)("div",{className:"text-secondary",children:"EnvoyÃ©s"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-green-600",children:e.deliveredCount.toLocaleString()}),(0,s.jsx)("div",{className:"text-secondary",children:"LivrÃ©s"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-red-600",children:e.failedCount.toLocaleString()}),(0,s.jsx)("div",{className:"text-secondary",children:"Ã‰checs"})]})]})]},e.type)})})]})}function v(e){return e?new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-"}let N={immediate:"ImmÃ©diat",scheduled:"PlanifiÃ©",cron:"RÃ©current"};function b({schedule:e}){return(0,s.jsxs)("div",{className:"card p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Informations de Planification"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"p-4 bg-muted rounded-lg",children:[(0,s.jsx)("div",{className:"text-sm text-secondary mb-1",children:"Type de Planification"}),(0,s.jsx)("div",{className:"font-semibold",children:N[e.type]})]}),(0,s.jsxs)("div",{className:"p-4 bg-muted rounded-lg",children:[(0,s.jsx)("div",{className:"text-sm text-secondary mb-1",children:"Fuseau Horaire"}),(0,s.jsx)("div",{className:"font-semibold",children:e.timezone})]}),e.scheduledAt&&(0,s.jsxs)("div",{className:"p-4 bg-muted rounded-lg",children:[(0,s.jsx)("div",{className:"text-sm text-secondary mb-1",children:"PlanifiÃ© Pour"}),(0,s.jsx)("div",{className:"font-semibold",children:v(e.scheduledAt)})]}),e.cronExpression&&(0,s.jsxs)("div",{className:"p-4 bg-muted rounded-lg",children:[(0,s.jsx)("div",{className:"text-sm text-secondary mb-1",children:"Expression Cron"}),(0,s.jsx)("div",{className:"font-mono font-semibold",children:e.cronExpression})]}),e.lastRunAt&&(0,s.jsxs)("div",{className:"p-4 bg-muted rounded-lg",children:[(0,s.jsx)("div",{className:"text-sm text-secondary mb-1",children:"DerniÃ¨re ExÃ©cution"}),(0,s.jsx)("div",{className:"font-semibold",children:v(e.lastRunAt)})]}),e.nextRunAt&&(0,s.jsxs)("div",{className:"p-4 bg-muted rounded-lg",children:[(0,s.jsx)("div",{className:"text-sm text-secondary mb-1",children:"Prochaine ExÃ©cution"}),(0,s.jsx)("div",{className:"font-semibold",children:v(e.nextRunAt)})]})]})]})}let f={pending:"bg-gray-100 text-gray-700",sent:"bg-blue-100 text-blue-700",delivered:"bg-green-100 text-green-700",failed:"bg-red-100 text-red-700"};function y({recipients:e,onExport:t}){let a=e.reduce((e,s)=>(e[s.status]=(e[s.status]||0)+1,e),{});return(0,s.jsxs)("div",{className:"card p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold",children:["Destinataires (",e.length,")"]}),(0,s.jsx)("button",{onClick:t,className:"btn btn-outline text-sm",children:"Exporter CSV"})]}),(0,s.jsx)("div",{className:"flex gap-4 mb-4",children:Object.entries(a).map(([e,t])=>(0,s.jsx)("div",{className:"text-sm",children:(0,s.jsxs)("span",{className:`px-2 py-1 rounded ${f[e]}`,children:[e,": ",t]})},e))}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-sm",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-border",children:[(0,s.jsx)("th",{className:"text-left py-2 px-3",children:"Nom"}),(0,s.jsx)("th",{className:"text-left py-2 px-3",children:"Email"}),(0,s.jsx)("th",{className:"text-left py-2 px-3",children:"TÃ©lÃ©phone"}),(0,s.jsx)("th",{className:"text-left py-2 px-3",children:"Statut"}),(0,s.jsx)("th",{className:"text-left py-2 px-3",children:"EnvoyÃ© Le"})]})}),(0,s.jsx)("tbody",{children:e.map(e=>{var t;return(0,s.jsxs)("tr",{className:"border-b border-border hover:bg-muted/50",children:[(0,s.jsx)("td",{className:"py-2 px-3 font-medium",children:e.name}),(0,s.jsx)("td",{className:"py-2 px-3",children:e.email||"-"}),(0,s.jsx)("td",{className:"py-2 px-3",children:e.phone||"-"}),(0,s.jsxs)("td",{className:"py-2 px-3",children:[(0,s.jsx)("span",{className:`px-2 py-0.5 rounded text-xs ${f[e.status]}`,children:e.status}),e.error&&(0,s.jsx)("span",{className:"ml-2 text-xs text-error",title:e.error,children:"âš ï¸"})]}),(0,s.jsx)("td",{className:"py-2 px-3 text-secondary",children:(t=e.sentAt)?new Date(t).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-"})]},e.id)})})]})})]})}function C(){let e=(0,t.useParams)(),n=(0,t.useRouter)(),{campaign:c,isLoading:m,error:x,handleCancel:u,handleRetry:p,handleExport:j}=function(e){let[s,t]=(0,a.useState)(null),[n,c]=(0,a.useState)(!0),[m,o]=(0,a.useState)(null),x=(0,a.useCallback)(async()=>{c(!0),o(null);try{let s=await i(e);t(s)}catch(e){o(e instanceof Error?e.message:"Failed to load campaign")}finally{c(!1)}},[e]);(0,a.useEffect)(()=>{x()},[x]);let u=(0,a.useCallback)(async()=>{try{await l(e),await x()}catch(e){o(e instanceof Error?e.message:"Failed to cancel")}},[e,x]),h=(0,a.useCallback)(async()=>{try{await r(e),await x()}catch(e){o(e instanceof Error?e.message:"Failed to retry")}},[e,x]);return{campaign:s,isLoading:n,error:m,refresh:x,handleCancel:u,handleRetry:h,handleExport:(0,a.useCallback)(async()=>{try{let s=await d(e),t=URL.createObjectURL(s),a=document.createElement("a");a.href=t,a.download=`campaign-${e}-recipients.csv`,a.click(),URL.revokeObjectURL(t)}catch(e){o(e instanceof Error?e.message:"Failed to export")}},[e])}}(e.id);if(m)return(0,s.jsx)("div",{className:"p-6 max-w-6xl mx-auto",children:(0,s.jsx)("div",{className:"text-center py-12 text-secondary",children:"Chargement des dÃ©tails de la campagne..."})});if(x||!c)return(0,s.jsx)("div",{className:"p-6 max-w-6xl mx-auto",children:(0,s.jsxs)("div",{className:"card p-6 text-center",children:[(0,s.jsx)("div",{className:"text-error mb-4",children:x||"Campagne non trouvÃ©e"}),(0,s.jsx)("button",{onClick:()=>n.push("/communications"),className:"btn btn-primary",children:"Retour aux Communications"})]})});let v="scheduled"===c.status||"sending"===c.status,N="failed"===c.status;return(0,s.jsxs)("div",{className:"p-6 max-w-6xl mx-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("button",{onClick:()=>n.push("/communications"),className:"btn btn-outline",children:"â† Retour"}),(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"DÃ©tails de la Campagne"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[v&&(0,s.jsx)("button",{onClick:u,className:"btn btn-outline text-error",children:"Annuler la Campagne"}),N&&(0,s.jsx)("button",{onClick:p,className:"btn btn-primary",children:"RÃ©essayer les Ã‰checs"})]})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)(o,{campaign:c}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsx)(h,{target:c.target}),(0,s.jsx)(b,{schedule:c.schedule})]}),(0,s.jsx)(g,{channels:c.channels}),(0,s.jsx)(y,{recipients:c.recipients,onExport:j})]})]})}e.s(["CampaignDetailClient",()=>C],81418)}]);