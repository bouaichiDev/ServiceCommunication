(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,48603,e=>{"use strict";var t=e.i(43476),a=e.i(18566),s=e.i(71645);let n=[{id:"1",name:"Campagne de Bienvenue T1",status:"sent",channels:["email","sms"],targetScope:"client",recipientCount:1250,scheduledAt:null,sentAt:"2024-01-15T10:30:00Z",createdAt:"2024-01-14T09:00:00Z",createdBy:"Jean Directeur"},{id:"2",name:"Newsletter Mensuelle",status:"scheduled",channels:["email"],targetScope:"final_client",recipientCount:5420,scheduledAt:"2024-02-01T08:00:00Z",sentAt:null,createdAt:"2024-01-20T14:00:00Z",createdBy:"Marie Admin"},{id:"3",name:"Rappel Formation Personnel",status:"draft",channels:["email","notification"],targetScope:"staff",recipientCount:85,scheduledAt:null,sentAt:null,createdAt:"2024-01-22T11:00:00Z",createdBy:"Jean Directeur"},{id:"4",name:"Alerte Promotion",status:"sending",channels:["sms","whatsapp"],targetScope:"client",recipientCount:3200,scheduledAt:null,sentAt:null,createdAt:"2024-01-23T16:00:00Z",createdBy:"Ã‰quipe Marketing"},{id:"5",name:"Avis Maintenance SystÃ¨me",status:"failed",channels:["email","sms","notification"],targetScope:"tenant",recipientCount:150,scheduledAt:"2024-01-10T22:00:00Z",sentAt:null,createdAt:"2024-01-09T10:00:00Z",createdBy:"Admin SystÃ¨me"}];async function l(e){await new Promise(e=>setTimeout(e,500));let t=[...n];if(e.status&&(t=t.filter(t=>t.status===e.status)),e.channel&&(t=t.filter(t=>t.channels.includes(e.channel))),e.search){let a=e.search.toLowerCase();t=t.filter(e=>e.name.toLowerCase().includes(a))}let a=(e.page-1)*e.limit;return{data:t.slice(a,a+e.limit),total:t.length,page:e.page,limit:e.limit}}async function i(e){await new Promise(e=>setTimeout(e,300)),console.log(`Deleted communication: ${e}`)}async function r(e){await new Promise(e=>setTimeout(e,300));let t=n.find(t=>t.id===e);if(!t)throw Error("Communication not found");return{...t,id:Date.now().toString(),name:`${t.name} (Copy)`,status:"draft",sentAt:null,createdAt:new Date().toISOString()}}let c={draft:"bg-gray-100 text-gray-700",scheduled:"bg-blue-100 text-blue-700",sending:"bg-yellow-100 text-yellow-700",sent:"bg-green-100 text-green-700",failed:"bg-red-100 text-red-700"},d={email:"âœ‰ï¸",sms:"ðŸ’¬",whatsapp:"ðŸ“±",notification:"ðŸ””"};function o(e){return e?new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-"}function u({communications:e,onView:a,onEdit:s,onDelete:n,onDuplicate:l}){return 0===e.length?(0,t.jsx)("div",{className:"text-center py-12 text-secondary",children:"Aucune communication trouvÃ©e. CrÃ©ez votre premiÃ¨re campagne !"}):(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-border",children:[(0,t.jsx)("th",{className:"text-left py-3 px-4 font-medium text-secondary",children:"Nom"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-medium text-secondary",children:"Statut"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-medium text-secondary",children:"Canaux"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-medium text-secondary",children:"Destinataires"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-medium text-secondary",children:"PlanifiÃ©"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-medium text-secondary",children:"CrÃ©Ã©"}),(0,t.jsx)("th",{className:"text-right py-3 px-4 font-medium text-secondary",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:e.map(e=>(0,t.jsxs)("tr",{className:"border-b border-border hover:bg-muted/50",children:[(0,t.jsxs)("td",{className:"py-3 px-4",children:[(0,t.jsx)("button",{onClick:()=>a(e.id),className:"font-medium text-primary hover:underline",children:e.name}),(0,t.jsx)("div",{className:"text-sm text-secondary",children:e.createdBy})]}),(0,t.jsx)("td",{className:"py-3 px-4",children:(0,t.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${c[e.status]}`,children:e.status})}),(0,t.jsx)("td",{className:"py-3 px-4",children:(0,t.jsx)("div",{className:"flex gap-1",children:e.channels.map(e=>(0,t.jsx)("span",{title:e,children:d[e]},e))})}),(0,t.jsx)("td",{className:"py-3 px-4",children:e.recipientCount.toLocaleString()}),(0,t.jsx)("td",{className:"py-3 px-4 text-sm",children:o(e.scheduledAt)}),(0,t.jsx)("td",{className:"py-3 px-4 text-sm",children:o(e.createdAt)}),(0,t.jsx)("td",{className:"py-3 px-4",children:(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>s(e.id),className:"btn btn-outline text-sm py-1 px-2",children:"Modifier"}),(0,t.jsx)("button",{onClick:()=>l(e.id),className:"btn btn-outline text-sm py-1 px-2",children:"Copier"}),(0,t.jsx)("button",{onClick:()=>n(e.id),className:"btn btn-outline text-sm py-1 px-2 text-error hover:bg-red-50",children:"Supprimer"})]})})]},e.id))})]})})}let m=["draft","scheduled","sending","sent","failed"],x=["email","sms","whatsapp","notification"];function h({statusFilter:e,channelFilter:a,search:s,onStatusChange:n,onChannelChange:l,onSearchChange:i}){return(0,t.jsxs)("div",{className:"flex flex-wrap gap-4 items-center",children:[(0,t.jsx)("div",{className:"flex-1 min-w-[200px]",children:(0,t.jsx)("input",{type:"text",placeholder:"Rechercher des communications...",value:s,onChange:e=>i(e.target.value),className:"input"})}),(0,t.jsx)("div",{children:(0,t.jsxs)("select",{value:e||"",onChange:e=>n(e.target.value||void 0),className:"input min-w-[150px]",children:[(0,t.jsx)("option",{value:"",children:"Tous les statuts"}),m.map(e=>(0,t.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))]})}),(0,t.jsx)("div",{children:(0,t.jsxs)("select",{value:a||"",onChange:e=>l(e.target.value||void 0),className:"input min-w-[150px]",children:[(0,t.jsx)("option",{value:"",children:"Tous les canaux"}),x.map(e=>(0,t.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))]})})]})}function p({currentPage:e,totalItems:a,itemsPerPage:s,onPageChange:n}){let l=Math.ceil(a/s);if(l<=1)return null;let i=Array.from({length:l},(e,t)=>t+1),r=Math.min(e*s,a);return(0,t.jsxs)("div",{className:"flex items-center justify-between py-4",children:[(0,t.jsxs)("div",{className:"text-sm text-secondary",children:["Affichage de ",(e-1)*s+1," Ã  ",r," sur ",a," rÃ©sultats"]}),(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsx)("button",{onClick:()=>n(e-1),disabled:1===e,className:"btn btn-outline py-1 px-3",children:"PrÃ©cÃ©dent"}),i.map(a=>(0,t.jsx)("button",{onClick:()=>n(a),className:`btn py-1 px-3 ${a===e?"btn-primary":"btn-outline"}`,children:a},a)),(0,t.jsx)("button",{onClick:()=>n(e+1),disabled:e===l,className:"btn btn-outline py-1 px-3",children:"Suivant"})]})]})}function f(){let e=(0,a.useRouter)(),{communications:n,total:c,isLoading:d,error:o,filters:m,setStatusFilter:x,setChannelFilter:f,setSearch:g,setPage:y,handleDelete:b,handleDuplicate:j}=function(){let[e,t]=(0,s.useState)([]),[a,n]=(0,s.useState)(0),[c,d]=(0,s.useState)(!0),[o,u]=(0,s.useState)(null),[m,x]=(0,s.useState)({page:1,limit:10}),h=(0,s.useCallback)(async()=>{d(!0),u(null);try{let e=await l(m);t(e.data),n(e.total)}catch(e){u(e instanceof Error?e.message:"Failed to load communications")}finally{d(!1)}},[m]);(0,s.useEffect)(()=>{h()},[h]);let p=(0,s.useCallback)(e=>{x(t=>({...t,status:e,page:1}))},[]),f=(0,s.useCallback)(e=>{x(t=>({...t,channel:e,page:1}))},[]),g=(0,s.useCallback)(e=>{x(t=>({...t,search:e||void 0,page:1}))},[]),y=(0,s.useCallback)(e=>{x(t=>({...t,page:e}))},[]),b=(0,s.useCallback)(async e=>{try{await i(e),await h()}catch(e){u(e instanceof Error?e.message:"Failed to delete")}},[h]),j=(0,s.useCallback)(async e=>{try{await r(e),await h()}catch(e){u(e instanceof Error?e.message:"Failed to duplicate")}},[h]);return{communications:e,total:a,isLoading:c,error:o,filters:m,setStatusFilter:p,setChannelFilter:f,setSearch:g,setPage:y,refresh:h,handleDelete:b,handleDuplicate:j}}();return(0,t.jsxs)("div",{className:"p-6 max-w-7xl mx-auto",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Communications"}),(0,t.jsx)("p",{className:"text-secondary",children:"GÃ©rez vos campagnes et alertes"})]}),(0,t.jsx)("button",{onClick:()=>{e.push("/campaign-builder")},className:"btn btn-primary",children:"+ Nouvelle Campagne"})]}),(0,t.jsx)("div",{className:"card p-4 mb-4",children:(0,t.jsx)(h,{statusFilter:m.status,channelFilter:m.channel,search:m.search||"",onStatusChange:x,onChannelChange:f,onSearchChange:g})}),(0,t.jsxs)("div",{className:"card",children:[o&&(0,t.jsx)("div",{className:"p-4 bg-red-50 text-error border-b border-border",children:o}),d?(0,t.jsx)("div",{className:"p-12 text-center text-secondary",children:"Chargement..."}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u,{communications:n,onView:t=>{e.push(`/campaign-details/${t}`)},onEdit:t=>{e.push(`/campaign-builder?edit=${t}`)},onDelete:b,onDuplicate:j}),(0,t.jsx)("div",{className:"px-4 border-t border-border",children:(0,t.jsx)(p,{currentPage:m.page,totalItems:c,itemsPerPage:m.limit,onPageChange:y})})]})]})]})}e.s(["default",()=>f],48603)}]);